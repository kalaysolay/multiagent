= Правила построения диаграммы пригодности (робастности) в синтаксисе PlantUML

== Общие требования

Для каждого нового базового прецедента (baseNew или Base, baseOld не трогай) построй MVC модель (диаграмма пригодности, Robustness diagram) в синтаксисе plantUML. Код диаграмм помести в отдельный сниппет plantUML для каждой диаграммы. Описание помести в сниппет asciidoc рядом с каждым сниппетом plantUML.

После построения диаграмм предложи свою группировку прецедентов для отрисовки mvc модели, так чтобы и фронтенд и бэкенд разработчикам было удобно работать с ними.

Для каждой MVC модели напиши ее цель в контексте базового варианта использования, краткое описание базового юзкейса на основе выдержки из нарратива и его связях с дочерними прецедентами. Перечисли акторов. Триггер - действие которое запускает экземпляр прецедента. Напиши предварительные условия и успешные финальные состояния и неуспешные состояния. Основной сценарий, затем альтернативные.

Перенеси акторов из диаграммы прецедентов и пассивные классы (претенденты на сущности БД) с диаграммы предметной области как есть, если они ассоциированы с данным конкретным базовым прецедентом.

Диаграмма пригодности явно учитывает все абстрактные прецеденты (включая abstract), которые входят в базовый. Сам базовый прецедент становится названием диаграммы (title). Абстрактные прецеденты и их вариации переносятся на mvc модель как контролы (control).

== Определение типа прецедента

Давай исходить из того, что если базовые прецеденты выполняются только на фронтенде (на фронте) нашего приложения, то в mvc нет элемента entity, поскольку на диаграмме робастности entity - это пассивный класс или другими словами - это таблица базы данных; если базовый прецедент выполняется и на фронте и на бэкенде (на бэке) то все типы элементов должны присутствовать; если только на бэке, то обязательно должен быть инициирующий контроллер.

== Направление и границы

Используй директиву left to right direction. Каждая модель MVC не должна выходить за рамки базового прецедента ни по смыслу ни по элементам.

== Допустимые связи

actor --|> actor
actor -- boundary
boundary -- control
control -- control
control -- entity
entity -- entity
entity --* entity
entity --0 entity
entity --|> entity

== Запрещенные связи

actor -- entity
actor -- control
boundary -- boundary
boundary -- entity

== Обязательные связи

actor -- boundary (если прецедент описывает взаимодействие пользователя и фронтенд приложения)
control -- entity (если прецедент описывает взаимодействие фронтенд и бэкенд приложений)

Вторичные акторы на диаграмме mvc не отображаются, здесь подразумевается, что мы отобразим контролы нашего приложения, которые взаимодействуют с внешними API, т.е. только действия в контуре разрабатываемого нами приложения.

== Контролы и стереотипы

Обогати краткое описание на основе нарратива, модели прецедентов (особенно учти абстрактные прецеденты). Добавь контролы альтернативных ветвей. И предложи разделение контролов на стереотипы << Frontend >> и << Backend >>

Frontend должен быть связан с граничным элементом boundary
все boundary в отношениях ставь слева "boundary -- " кроме отношений с актором


== Структура вывода

Для каждого базового прецедента создай отдельный блок PlantUML с описанием в формате AsciiDoc:

[source,asciidoc]
----
=== Название базового прецедента

Цель: [описание цели]

Краткое описание: [описание на основе нарратива]

Акторы: [список акторов]

Триггер: [действие, запускающее прецедент]

Предварительные условия: [список условий]

Успешное финальное состояние: [описание]

Неуспешные состояния: [описание]

Основной сценарий:
1. [шаг 1]
2. [шаг 2]
...

Альтернативные сценарии:
1. [альтернатива 1]
2. [альтернатива 2]
...

[source,plantuml]
----
@startuml mvc_[имя_прецедента]
' Header
    title [Название базового прецедента]
    skinparam WrapWidth 200
    left to right direction
    skinparam actor {
        actorStyle awesome << user >>
    }

' Actors
    [акторы]

' Boundaries - GUI
    [граничные элементы]

' Controls - контроллеры
    [контроллеры с стереотипами << Frontend >> или << Backend >>]

' Entities - пассивные классы
    [сущности БД, если есть]

@enduml
----

----

== Группировка прецедентов

После построения всех диаграмм предложи группировку прецедентов для удобной работы фронтенд и бэкенд разработчиков.

Строго следуй этим правилам. Раздели работу на этапы и проверяй каждый этап на соответствие этим правилам. Будь крайне самокритичным.

---

НАРРАТИВ:
%s

ДОМЕННАЯ МОДЕЛЬ (PlantUML):
%s

ДИАГРАММА ПРЕЦЕДЕНТОВ (PlantUML):
%s

КОНТЕКСТ СИСТЕМЫ (RAG):
%s

Сгенерируй MVC диаграммы для всех базовых прецедентов (baseNew или Base, baseOld не трогай) по правилам выше. Выведи результат в формате AsciiDoc с встроенными блоками PlantUML для каждой диаграммы. В конце предложи группировку прецедентов.


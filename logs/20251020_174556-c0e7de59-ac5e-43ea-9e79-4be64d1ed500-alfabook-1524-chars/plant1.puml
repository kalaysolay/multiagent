@startuml domain_model
Title Обратная связь в AlfaBook
skinparam WrapWidth 150

' Шаг 1. Анализ пользовательской истории
' Старт: Страница статьи AlfaBook
' Цель: Вопрос создан и отображается пользователю в "Мои вопросы" и редактору в "Обратная связь" админ-центра
' Последовательность: Открыть статью -> Нажать "Обратная связь" -> Заполнить форму (текст обязателен, файлы по ограничениям) -> Отправить -> Просмотр в ЛК и админке -> Открытие модального просмотра вопроса из ЛК
' Связи: Пользователь использует GUI-экраны; форма создает Вопрос; Вопрос включает до 10 Вложений; ЛК и Админцентр отображают Вопрос; модальное окно просмотра показывает Вопрос

' Шаг 2. Аффинизация существительных
' Пользователь → Пользователь (class)
' Редактор → Редактор (class, наследует Пользователь)
' Статья/страница → СтраницаСтатьи (GUI)
' Модальное окно с формой обратной связи/форма → МодальнаяФормаОбратнойСвязи (GUI)
' Текст, комментарий, форматирование → атрибуты текстHtml/текстПлейн у Вопрос; текстовое поле и визуальный редактор инкапсулированы в МодальнаяФормаОбратнойСвязи
' Файл/вложения → ВложениеФайла (entity)
' Вопрос → Вопрос (entity)
' Личный кабинет, раздел "Мои вопросы" → ЛичныйКабинет (GUI)
' Модальное окно просмотра вопроса → МодальноеОкноПросмотраВопроса (GUI)
' Центр администрирования, раздел "Обратная связь" → ЦентрАдминистрирования (GUI)
' Статус → атрибут статус у Вопрос
' Ограничения (кол-во, типы, размер) → атрибуты и валидация в МодальнаяФормаОбратнойСвязи и Вопрос/ВложениеФайла

' Шаг 6. Оценка сложности
' N = 9 элементов, C = 2^9 = 512

class "Пользователь" as user {
  + {field} userId: UUID
}

class "Редактор" as editor {
  + {field} editorId: UUID
}
editor --|> user

class "СтраницаСтатьи" as articlePage << (U, #d310e4) GUI >> {
  + {method} открытьФормуОбратнойСвязи()
}

class "МодальнаяФормаОбратнойСвязи" as feedbackForm << (U, #d310e4) GUI >> {
  + {field} текстКомментария: String
  + {field} допустимыеТипы: String[*] ' PDF, DOC, DOCX
  + {field} максРазмерМб: Int = 10
  + {field} максКоличествоФайлов: Int = 10
  + {field} количествоПрикрепленныхФайлов: Int
  + {field} кнопкаПрикрепитьДоступна: Boolean
  + {field} текстОбязателен: Boolean = true
  + {method} прикрепитьФайл()
  + {method} удалитьФайл()
  + {method} обновитьСостояниеКнопки()
  + {method} проверитьОбязательностьТекста()
  + {method} отправить()
  + {method} отменить()
  + {method} закрыть()
}

entity "Вопрос" as question {
  + {field} id: UUID
  + {field} текстHtml: String
  + {field} текстПлейн: String
  + {field} статус: String
  + {field} датаСоздания: DateTime
  + {method} добавитьВложение()
  + {method} проверитьОграниченияВложений()
}

entity "ВложениеФайла" as attachment {
  + {field} id: UUID
  + {field} имяФайла: String
  + {field} тип: String ' PDF|DOC|DOCX
  + {field} размерМб: Int
  + {method} проверитьДопустимость()
}

class "ЛичныйКабинет" as account << (U, #d310e4) GUI >> {
  + {field} списокВопросов: List<Вопрос>
  + {method} открытьМоиВопросы()
  + {method} открытьВопрос()
}

class "МодальноеОкноПросмотраВопроса" as questionModal << (U, #d310e4) GUI >> {
  + {field} отрендеренныйТекстHtml: String
  + {method} отобразитьВопрос()
}

class "ЦентрАдминистрирования" as adminCenter << (U, #d310e4) GUI >> {
  + {field} списокОбратнойСвязи: List<Вопрос>
  + {method} просмотретьОбратнуюСвязь()
}

' Отношения использования пользователем GUI
user ..> articlePage : использование
user ..> feedbackForm : использование
user ..> account : использование
user ..> questionModal : использование
editor ..> adminCenter : использование

' Отношения между GUI
articlePage *-- feedbackForm : открывает модалку
account *-- questionModal : открывает модалку

' Доменные связи
feedbackForm -- question : создает/заполняет
question "1" *-- "0..10" attachment : вложения
account -- question : мои вопросы
adminCenter -- question : обратная связь
questionModal -- question : отображает

@enduml